<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.65">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-125180910-5","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-125180910-5"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-125180910-5",{})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Apollo Angular" href="/opensearch.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,400,700,900&display=swap">
<script src="https://the-guild.dev/static/banner.js"></script><title data-react-helmet="true">Queries | Apollo Angular</title><meta data-react-helmet="true" name="docsearch:version" content="current,latest"><meta data-react-helmet="true" property="og:image" content="https://apollo-angular.com/img/cover.png"><meta data-react-helmet="true" property="twitter:image" content="https://apollo-angular.com/img/cover.png"><meta data-react-helmet="true" name="twitter:image:alt" content="Image for Apollo Angular"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Queries | Apollo Angular"><meta data-react-helmet="true" name="description" content="Fetch data with the Apollo service"><meta data-react-helmet="true" property="og:description" content="Fetch data with the Apollo service"><meta data-react-helmet="true" property="og:url" content="https://apollo-angular.com/docs/data/queries"><link data-react-helmet="true" rel="shortcut icon" href="/img/logo/favicon.png"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link data-react-helmet="true" rel="canonical" href="https://apollo-angular.com/docs/data/queries"><link rel="stylesheet" href="/styles.8e3b14bc.css">
<link rel="preload" href="/styles.76e54650.js" as="script">
<link rel="preload" href="/runtime~main.7cd10055.js" as="script">
<link rel="preload" href="/main.0a07585e.js" as="script">
<link rel="preload" href="/1.c7186910.js" as="script">
<link rel="preload" href="/2.d913e4e3.js" as="script">
<link rel="preload" href="/83.b1923a5e.js" as="script">
<link rel="preload" href="/86.14ac84bf.js" as="script">
<link rel="preload" href="/935f2afb.7956f57d.js" as="script">
<link rel="preload" href="/17896441.4982924e.js" as="script">
<link rel="preload" href="/c3759279.0af2a8a9.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><strong class="navbar__title">Apollo Angular</strong></a><div class="navbar__item dropdown dropdown--hoverable dropdown--left"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">v2</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/data/queries">v2</a></li><li><a class="dropdown__link" href="/docs/1.0/">1.0</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">API &amp; Documentation</a><a href="https://github.com/kamilkisiela/apollo-angular" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><a href="https://the-guild.dev/contact" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Support</a><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span><span class="DocSearch-Button-Key">âŒ˜</span><span class="DocSearch-Button-Key">K</span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><strong class="navbar__title">Apollo Angular</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist">Versions</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/docs/data/queries">v2</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/1.0/">1.0</a></li></ul></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs">API &amp; Documentation</a></li><li class="menu__list-item"><a href="https://github.com/kamilkisiela/apollo-angular" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li><li class="menu__list-item"><a href="https://the-guild.dev/contact" target="_blank" rel="noopener noreferrer" class="menu__link">Support</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Apollo Angular</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/migration">Migration Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/get-started">Get started</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Fetching</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/data/queries">Queries</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data/mutations">Mutations</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data/subscriptions">Subscriptions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data/services">Query, Mutation, Subscription services</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data/network">Network layer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data/pagination">Pagination</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data/fragments">Using Fragments</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/data/error-handling">Error handling</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Caching</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/caching/configuration">Configuring the cache</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/caching/interaction">Reading and writing data to the cache</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/caching/garbage-collection">Garbage collection and cache eviction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/caching/field-behavior">Customizing the behavior of cached fields</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/caching/advanced-topics">Advanced topics on caching</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Local State</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/local-state/management">Managing local state</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/local-state/managing-state-with-field-policies">Managing local state</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/local-state/reactive-variables">Reactive variables</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Development &amp; Testing</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/development-and-testing/using-typescript">Using Apollo with TypeScript</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/development-and-testing/testing">Testing Apollo in Angular</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/development-and-testing/client-schema-mocking">Mocking new schema capabilities</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/development-and-testing/developer-tools">Developer tools</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Performance</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/performance/improving-performance">Improving performance</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/performance/optimistic-ui">Optimistic UI</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/performance/server-side-rendering">Server Side Rendering</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Recipes</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/recipes/simple-example">Simple Example</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/recipes/automatic-persisted-queries">Automatic Persisted Queries</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/recipes/angular-cli">Angular CLI</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/recipes/webpack">Webpack loader</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/recipes/authentication">Authentication</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/recipes/multiple-clients">Multiple clients</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/recipes/nativescript">Integrating with NativeScript</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><div><span class="badge badge--secondary">Version: v2</span></div><header><h1 class="docTitle_1Lrw">Queries</h1></header><div class="markdown"><p>On this page, you can learn how to use Apollo to attach GraphQL query results to
your Angular UI. This guide assumes some familiarity with GraphQL itself. You
can read about GraphQL queries themselves in detail at
<a href="http://graphql.org/docs/queries/" target="_blank" rel="noopener noreferrer">graphql.org</a>.</p><p>One of our core values is &quot;it&#x27;s just GraphQL.&quot; When using Apollo Client, you
don&#x27;t have to learn anything special about the query syntax, since everything is
just standard GraphQL. Anything you can type into the GraphQL query IDE, you
can also put into your Apollo Client code.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="basic-queries"></a>Basic Queries<a aria-hidden="true" tabindex="-1" class="hash-link" href="#basic-queries" title="Direct link to heading">#</a></h2><p>When we are using a basic query, we can use the <code>Apollo.watchQuery</code> method in a
very simple way. We simply need to parse our query into a GraphQL document using
the <code>gql</code> tag from <code>@apollo/client/core</code> library.</p><p>For instance, <a href="https://graphql-voter-app.herokuapp.com/" target="_blank" rel="noopener noreferrer">in our example</a>, we want to display a list of posts in <code>Posts</code> component:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-typescript codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token keyword" style="color:#e3116c">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">Component</span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token imports"> </span><span class="token imports maybe-class-name">OnInit</span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token imports"> </span><span class="token imports maybe-class-name">OnDestroy</span><span class="token imports"> </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">from</span><span class="token plain"> </span><span class="token string">&#x27;@angular/core&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">Subscription</span><span class="token imports"> </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">from</span><span class="token plain"> </span><span class="token string">&#x27;rxjs&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">Apollo</span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token imports"> gql </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">from</span><span class="token plain"> </span><span class="token string">&#x27;apollo-angular&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// We use the gql tag to parse our query string into a query document</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">GET_POST</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> gql</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">  query GetPosts {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">    posts {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">      id</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">      title</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string"></span><span class="token template-string template-punctuation string">`</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@</span><span class="token function maybe-class-name" style="color:rgb(111, 66, 193)">Component</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token spread operator" style="color:rgb(0, 92, 197)">...</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">class</span><span class="token plain"> </span><span class="token class-name maybe-class-name" style="color:rgb(227, 98, 9)">PostsComponent</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">implements</span><span class="token plain"> </span><span class="token class-name maybe-class-name" style="color:rgb(227, 98, 9)">OnInit</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token maybe-class-name">OnDestroy</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  loading</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token builtin" style="color:#e3116c">boolean</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  posts</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token builtin" style="color:#e3116c">any</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword" style="color:#e3116c">private</span><span class="token plain"> querySubscription</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token maybe-class-name">Subscription</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword" style="color:#e3116c">constructor</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token keyword" style="color:#e3116c">private</span><span class="token plain"> apollo</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token maybe-class-name">Apollo</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token function" style="color:rgb(111, 66, 193)">ngOnInit</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">this</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">querySubscription</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">this</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">apollo</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token generic-function function" style="color:rgb(111, 66, 193)">watchQuery</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 92, 197)">&lt;</span><span class="token generic-function generic class-name builtin" style="color:#e3116c">any</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      query</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">GET_POSTS</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">valueChanges</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">subscribe</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> loading </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 92, 197)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token keyword" style="color:#e3116c">this</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">loading</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> loading</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token keyword" style="color:#e3116c">this</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">posts</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">posts</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token function" style="color:rgb(111, 66, 193)">ngOnDestroy</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">this</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">querySubscription</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">unsubscribe</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div></div></div><p>The <code>watchQuery</code> method returns a <code>QueryRef</code> object which has the <code>valueChanges</code>
property that is an <code>Observable</code>.</p><p>We can see that the result object contains <code>loading</code>, a Boolean indicating if
the query is &quot;in-flight.&quot; The observable will only emit once when the query is
complete, and <code>loading</code> will be set to false unless you set the <code>watchQuery</code>
parameters <code>notifyOnNetworkStatusChange</code> to true. Once
the query has completed, it will also contain a <code>data</code> object with
<code>posts</code>, the field we&#x27;ve picked out in <code>GetPosts</code> operation.</p><p>It&#x27;s also possible to fetch data only once. The <code>query</code> method of <code>Apollo</code>
service returns an <code>Observable</code> that also resolves with the same result as
above.</p><p>Imagine you have two views (routes), one of them has the <code>Posts</code> component. When you switch between views, you&#x27;ll notice that the list of posts loads instantly the second time. This is the Apollo cache at work!</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="what-is-queryref"></a>What is QueryRef<a aria-hidden="true" tabindex="-1" class="hash-link" href="#what-is-queryref" title="Direct link to heading">#</a></h3><p>As you know, <code>Apollo.query</code> method returns an Observable that emits a result,
just once. <code>Apollo.watchQuery</code> also does the same, except it can emit multiple
results. (The GraphQL query itself is still only sent once, but the <code>watchQuery</code>
observable can also update if, for example, another query causes the object to
be updated within Apollo Client&#x27;s global cache.)</p><p>So why doesn&#x27;t <code>Apollo.watchQuery</code> expose an Observable?</p><p>Apollo service and ApolloClient share pretty much the same API. It makes things
easy to understand and use. No reason to change it.</p><p>In <code>ApolloClient.watchQuery</code> returns an Observable, but not a standard one, it
contains many useful methods (like <code>refetch()</code>) to manipulate the watched query.
A normal Observable, has only one method, <code>subscribe()</code>.</p><p>To use that Apollo&#x27;s Observable in RxJS, we would have to drop those methods.
Since they are necessary to use Apollo to its full potential, we had to come up
with a solution.</p><p>This is why we created <code>QueryRef</code>.</p><p>The API of <code>QueryRef</code> is very simple. It has the same methods as the Apollo
Observable we talked about. To subscribe to query results, you have to access its
<code>valueChanges</code> property which exposes a clean RxJS Observable.</p><p>It&#x27;s worth mentioning that <code>QueryRef</code> accepts two generic types.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="providing-options"></a>Providing <code>options</code><a aria-hidden="true" tabindex="-1" class="hash-link" href="#providing-options" title="Direct link to heading">#</a></h2><p>The <code>watchQuery</code> and <code>query</code> methods expect one argument, an object with options. If
you want to configure the query, you can provide any available option in the
same object where the <code>query</code> key lives.</p><p>If your query takes variables, this is the place to pass them in:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-typescript codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token comment" style="color:rgb(106, 153, 85)">// Suppose our profile query took an avatar size</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">GET_POSTS_OF_AUTHOR</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> gql</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">  query GetPostsOfAuthor($authorId: Int!) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">    postsOf(authorId: $authorId) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">      id</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">      title</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string"></span><span class="token template-string template-punctuation string">`</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@</span><span class="token function maybe-class-name" style="color:rgb(111, 66, 193)">Component</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token spread operator" style="color:rgb(0, 92, 197)">...</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">class</span><span class="token plain"> </span><span class="token class-name maybe-class-name" style="color:rgb(227, 98, 9)">PostsOfUserComponent</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">implements</span><span class="token plain"> </span><span class="token class-name maybe-class-name" style="color:rgb(227, 98, 9)">OnInit</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token maybe-class-name">OnDestroy</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  posts</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token builtin" style="color:#e3116c">any</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword" style="color:#e3116c">private</span><span class="token plain"> querySubscription</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token maybe-class-name">Subscription</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token function" style="color:rgb(111, 66, 193)">ngOnInit</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">this</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">querySubscription</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">this</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">apollo</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">watchQuery</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        query</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">GET_POSTS_OF_AUTHOR</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        variables</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          authorId</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token number">12</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">valueChanges</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">subscribe</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 92, 197)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token keyword" style="color:#e3116c">this</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">posts</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">postsOf</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token function" style="color:rgb(111, 66, 193)">ngOnDestroy</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">this</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">querySubscription</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">unsubscribe</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="using-with-asyncpipe"></a>Using with AsyncPipe<a aria-hidden="true" tabindex="-1" class="hash-link" href="#using-with-asyncpipe" title="Direct link to heading">#</a></h2><p>In Angular, the simplest way of displaying data that comes from Observable is to
put <code>AsyncPipe</code> on top of the property inside the UI. You can also achieve this
with Apollo.</p><blockquote><p>Note: Using async pipe more than once in your template will trigger the query for each pipe. To avoid this situation, subscribe to the data in the component, and display the data from the component&#x27;s property.</p></blockquote><p>An Observable returned by <code>watchQuery().valueChanges</code> holds the actual result
under the <code>data</code> field, so you can not directly access one of the properties of
that object.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-typescript codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token keyword" style="color:#e3116c">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token imports maybe-class-name">Component</span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token imports"> </span><span class="token imports maybe-class-name">OnInit</span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">from</span><span class="token plain"> </span><span class="token string">&#x27;@angular/core&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token imports maybe-class-name">Apollo</span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token imports"> gql</span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">from</span><span class="token plain"> </span><span class="token string">&#x27;apollo-angular&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token imports maybe-class-name">Observable</span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">from</span><span class="token plain"> </span><span class="token string">&#x27;rxjs&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token imports">map</span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">from</span><span class="token plain"> </span><span class="token string">&#x27;rxjs/operators&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">GET_FEED</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> gql</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">  query GetFeed {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">    authors {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">      id</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">      firstName</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">      lastName</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">    posts {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">      it</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">      title</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string"></span><span class="token template-string template-punctuation string">`</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@</span><span class="token function maybe-class-name" style="color:rgb(111, 66, 193)">Component</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  template</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token template-string template-punctuation string">`</span><span class="token template-string string"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">    &lt;ul&gt;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">      &lt;li *ngFor=&quot;let post of posts | async&quot;&gt;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">        {{ post.title }}</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">      &lt;/li&gt;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">    &lt;/ul&gt;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">  </span><span class="token template-string template-punctuation string">`</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">class</span><span class="token plain"> </span><span class="token class-name maybe-class-name" style="color:rgb(227, 98, 9)">FeedComponent</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">implements</span><span class="token plain"> </span><span class="token class-name maybe-class-name" style="color:rgb(227, 98, 9)">OnInit</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  posts</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token maybe-class-name">Observable</span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;</span><span class="token builtin" style="color:#e3116c">any</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword" style="color:#e3116c">constructor</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token keyword" style="color:#e3116c">private</span><span class="token plain"> apollo</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token maybe-class-name">Apollo</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token function" style="color:rgb(111, 66, 193)">ngOnInit</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">this</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">posts</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">this</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">apollo</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">watchQuery</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain">query</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">GET_FEED</span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">valueChanges</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">pipe</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token function" style="color:rgb(111, 66, 193)">map</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">result</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 92, 197)">=&gt;</span><span class="token plain"> result</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">data</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">posts</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div></div></div><p>The result of the query has this structure:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-typescripton codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">{</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  &quot;data&quot;: {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    &quot;authors&quot;: [ ... ],</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    &quot;posts&quot;: [ ... ]</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div></div></div><p>Without using the <code>map</code> operator, you would get the whole object instead of only the
<code>data.posts</code>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="updating-cached-query-results"></a>Updating cached query results<a aria-hidden="true" tabindex="-1" class="hash-link" href="#updating-cached-query-results" title="Direct link to heading">#</a></h2><p>Caching query results is handy and easy to do, but sometimes you want to make sure that cached data is up to date with your server. Apollo Client supports two strategies for this: <strong>polling</strong> and <strong>refetching</strong>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="polling"></a>Polling<a aria-hidden="true" tabindex="-1" class="hash-link" href="#polling" title="Direct link to heading">#</a></h3><p>Polling provides near-real-time synchronization with your server by causing a query to execute periodically at a specified interval. To enable polling for a query, pass a <code>pollInterval</code> configuration option to the <code>Apollo.watchQuery</code> with an interval in milliseconds:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-typescript codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token keyword" style="color:#e3116c">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">Component</span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token imports"> </span><span class="token imports maybe-class-name">OnInit</span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token imports"> </span><span class="token imports maybe-class-name">OnDestroy</span><span class="token imports"> </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">from</span><span class="token plain"> </span><span class="token string">&#x27;@angular/core&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">Subscription</span><span class="token imports"> </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">from</span><span class="token plain"> </span><span class="token string">&#x27;rxjs&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">Apollo</span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token imports"> gql </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">from</span><span class="token plain"> </span><span class="token string">&#x27;apollo-angular&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// We use the gql tag to parse our query string into a query document</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">GET_POST</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> gql</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">  query GetPosts {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">    posts {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">      id</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">      title</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string"></span><span class="token template-string template-punctuation string">`</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@</span><span class="token function maybe-class-name" style="color:rgb(111, 66, 193)">Component</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token spread operator" style="color:rgb(0, 92, 197)">...</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">class</span><span class="token plain"> </span><span class="token class-name maybe-class-name" style="color:rgb(227, 98, 9)">PostsComponent</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">implements</span><span class="token plain"> </span><span class="token class-name maybe-class-name" style="color:rgb(227, 98, 9)">OnInit</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token maybe-class-name">OnDestroy</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  loading</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token builtin" style="color:#e3116c">boolean</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  posts</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token builtin" style="color:#e3116c">any</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword" style="color:#e3116c">private</span><span class="token plain"> querySubscription</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token maybe-class-name">Subscription</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword" style="color:#e3116c">constructor</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token keyword" style="color:#e3116c">private</span><span class="token plain"> apollo</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token maybe-class-name">Apollo</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token function" style="color:rgb(111, 66, 193)">ngOnInit</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">this</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">querySubscription</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">this</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">apollo</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token generic-function function" style="color:rgb(111, 66, 193)">watchQuery</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 92, 197)">&lt;</span><span class="token generic-function generic class-name builtin" style="color:#e3116c">any</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      query</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">GET_POSTS</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      pollInterval</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token number">500</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">valueChanges</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">subscribe</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> loading </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 92, 197)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token keyword" style="color:#e3116c">this</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">loading</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> loading</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token keyword" style="color:#e3116c">this</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">posts</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">posts</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token function" style="color:rgb(111, 66, 193)">ngOnDestroy</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">this</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">querySubscription</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">unsubscribe</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div></div></div><p>By setting the <code>pollInterval</code> to <code>500</code>, you&#x27;ll fetch the list of posts from the server every 0.5 seconds. Note that if you set <code>pollInterval</code> to <code>0</code>, the query will <strong>not</strong> poll.</p><blockquote><p>You can also start and stop polling dynamically with the <code>startPolling</code> and <code>stopPolling</code> functions that are available in the <code>QueryRef</code> object returned by <code>Apollo.watchQuery()</code></p></blockquote><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="refetching"></a>Refetching<a aria-hidden="true" tabindex="-1" class="hash-link" href="#refetching" title="Direct link to heading">#</a></h3><p>Refetching enables you to refresh query results in response to a particular user action, as opposed to using a fixed interval.</p><p>Let&#x27;s add a button to our <code>Posts</code> component that calls our query&#x27;s refetch function whenever it&#x27;s clicked.</p><blockquote><p>You can optionally provide a new <code>variables</code> object to the refetch function. If you don&#x27;t (as is the case in the following example), the query uses the same variables that it used in its previous execution.</p></blockquote><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-typescript codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token keyword" style="color:#e3116c">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">Component</span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token imports"> </span><span class="token imports maybe-class-name">OnInit</span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token imports"> </span><span class="token imports maybe-class-name">OnDestroy</span><span class="token imports"> </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">from</span><span class="token plain"> </span><span class="token string">&#x27;@angular/core&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">Subscription</span><span class="token imports"> </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">from</span><span class="token plain"> </span><span class="token string">&#x27;rxjs&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">Apollo</span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token imports"> </span><span class="token imports maybe-class-name">QueryRef</span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token imports"> gql </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">from</span><span class="token plain"> </span><span class="token string">&#x27;apollo-angular&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// We use the gql tag to parse our query string into a query document</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">GET_POST</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> gql</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">  query GetPosts {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">    posts {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">      id</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">      title</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string">  }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token template-string string"></span><span class="token template-string template-punctuation string">`</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@</span><span class="token function maybe-class-name" style="color:rgb(111, 66, 193)">Component</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token spread operator" style="color:rgb(0, 92, 197)">...</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">class</span><span class="token plain"> </span><span class="token class-name maybe-class-name" style="color:rgb(227, 98, 9)">PostsComponent</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">implements</span><span class="token plain"> </span><span class="token class-name maybe-class-name" style="color:rgb(227, 98, 9)">OnInit</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token maybe-class-name">OnDestroy</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  loading</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token builtin" style="color:#e3116c">boolean</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  posts</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token builtin" style="color:#e3116c">any</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  postsQuery</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token maybe-class-name">QueryRef</span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;</span><span class="token builtin" style="color:#e3116c">any</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword" style="color:#e3116c">private</span><span class="token plain"> querySubscription</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token maybe-class-name">Subscription</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword" style="color:#e3116c">constructor</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token keyword" style="color:#e3116c">private</span><span class="token plain"> apollo</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token maybe-class-name">Apollo</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token function" style="color:rgb(111, 66, 193)">ngOnInit</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">this</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">postsQuery</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">this</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">apollo</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token generic-function function" style="color:rgb(111, 66, 193)">watchQuery</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 92, 197)">&lt;</span><span class="token generic-function generic class-name builtin" style="color:#e3116c">any</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      query</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">GET_POSTS</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      pollInterval</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token number">500</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">this</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">querySubscription</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">this</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">postsQuery</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">valueChanges</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">subscribe</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> loading </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 92, 197)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token keyword" style="color:#e3116c">this</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">loading</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> loading</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token keyword" style="color:#e3116c">this</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">posts</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">posts</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token function" style="color:rgb(111, 66, 193)">refresh</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">this</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">postsQuery</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">refetch</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token function" style="color:rgb(111, 66, 193)">ngOnDestroy</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">this</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">querySubscription</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">unsubscribe</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div></div></div><p>Call the <code>refresh</code> method and notice that the UI updates with a new dog photo. Refetching is an excellent way to guarantee fresh data, but it introduces some complexity with loading state. In the next section, we&#x27;ll cover strategies for handling complex loading and error state.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="inspecting-error-states"></a>Inspecting error states<a aria-hidden="true" tabindex="-1" class="hash-link" href="#inspecting-error-states" title="Direct link to heading">#</a></h3><p>You can customize your query error handling by providing the <code>errorPolicy</code> configuration option to <code>Apollo.watchQuery</code> or <code>Apollo.query</code>. The default value is <code>none</code>, which tells Apollo Angular to treat all GraphQL errors as runtime errors. In this case, Apollo Angular discards any query response data returned by the server and sets the error property in the result object to true.</p><p>If you set <code>errorPolicy</code> to <code>all</code>, Apollo Angular does not discard query response data, allowing you to render partial results.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="loading-state"></a>Loading state<a aria-hidden="true" tabindex="-1" class="hash-link" href="#loading-state" title="Direct link to heading">#</a></h3><p>Every response you get from <code>Apollo.watchQuery()</code> contains <code>loading</code> property. By default, it&#x27;s always <code>false</code> and the first result is emitted with the response from the ApolloLink execution chain. In order to correct it you can enable <code>useInitialLoading</code> flag in configuration.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-typescript codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token keyword" style="color:#e3116c">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token imports maybe-class-name">HttpClientModule</span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">from</span><span class="token plain"> </span><span class="token string">&#x27;@angular/common/http&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token maybe-class-name">ApolloModule</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">APOLLO_OPTIONS</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">APOLLO_FLAGS</span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">from</span><span class="token plain"> </span><span class="token string">&#x27;apollo-angular&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token imports maybe-class-name">HttpLink</span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">from</span><span class="token plain"> </span><span class="token string">&#x27;apollo-angular/http&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token imports maybe-class-name">InMemoryCache</span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">from</span><span class="token plain"> </span><span class="token string">&#x27;@apollo/client/core&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@</span><span class="token function maybe-class-name" style="color:rgb(111, 66, 193)">NgModule</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  imports</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token maybe-class-name">BrowserModule</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token maybe-class-name">ApolloModule</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token maybe-class-name">HttpClientModule</span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  providers</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      provide</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">APOLLO_FLAGS</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      useValue</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        useInitialLoading</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(0, 92, 197)">true</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// enable it here</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      provide</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">APOLLO_OPTIONS</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token function-variable function" style="color:rgb(111, 66, 193)">useFactory</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">httpLink</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token maybe-class-name">HttpLink</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 92, 197)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token keyword" style="color:#e3116c">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          cache</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">new</span><span class="token plain"> </span><span class="token class-name maybe-class-name" style="color:rgb(227, 98, 9)">InMemoryCache</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          link</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> httpLink</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">create</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            uri</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token string">&#x27;https://48p1r2roz4.sse.codesandbox.io&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      deps</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token maybe-class-name">HttpLink</span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">export</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">class</span><span class="token plain"> </span><span class="token class-name maybe-class-name" style="color:rgb(227, 98, 9)">AppModule</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div></div></div><blockquote><p><code>useInitialLoading</code> is disabled to avoid any breaking changes, this may be enabled in next major version.</p></blockquote></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/kamilkisiela/apollo-angular/edit/master/website/docs/data/queries.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/get-started"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Get started</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/data/mutations"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Mutations Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#basic-queries" class="table-of-contents__link">Basic Queries</a><ul><li><a href="#what-is-queryref" class="table-of-contents__link">What is QueryRef</a></li></ul></li><li><a href="#providing-options" class="table-of-contents__link">Providing <code>options</code></a></li><li><a href="#using-with-asyncpipe" class="table-of-contents__link">Using with AsyncPipe</a></li><li><a href="#updating-cached-query-results" class="table-of-contents__link">Updating cached query results</a><ul><li><a href="#polling" class="table-of-contents__link">Polling</a></li><li><a href="#refetching" class="table-of-contents__link">Refetching</a></li><li><a href="#inspecting-error-states" class="table-of-contents__link">Inspecting error states</a></li><li><a href="#loading-state" class="table-of-contents__link">Loading state</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/data/queries">Fetching</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/local-state/management">Local State</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://discord.gg/xud7bH9" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li><li class="footer__item"><a href="https://the-guild.dev/open-source" target="_blank" rel="noopener noreferrer" class="footer__link-item">Other projects</a></li><li class="footer__item"><a href="https://the-guild.dev" target="_blank" rel="noopener noreferrer" class="footer__link-item">About us</a></li><li class="footer__item"><a href="https://github.com/the-guild-org/community-meetings" target="_blank" rel="noopener noreferrer" class="footer__link-item">Community Meetings</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Social</h4><ul class="footer__items"><li class="footer__item"><a href="https://the-guild.dev/blog" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li><li class="footer__item"><a href="https://github.com/kamilkisiela/apollo-angular" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://twitter.com/kamilkisiela" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://www.linkedin.com/company/the-guild-software" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn</a></li></ul></div></div><div class="text--center"><div>Copyright Â© 2021 Kamil Kisiela. All rights reserved.</div></div></div></footer></div>
<script src="/styles.76e54650.js"></script>
<script src="/runtime~main.7cd10055.js"></script>
<script src="/main.0a07585e.js"></script>
<script src="/1.c7186910.js"></script>
<script src="/2.d913e4e3.js"></script>
<script src="/83.b1923a5e.js"></script>
<script src="/86.14ac84bf.js"></script>
<script src="/935f2afb.7956f57d.js"></script>
<script src="/17896441.4982924e.js"></script>
<script src="/c3759279.0af2a8a9.js"></script>
</body>
</html>